function llenarFormulario(){var c=dijit.byId("departamento");var e=dijit.byId("provincia");var d=dijit.byId("distrito");var f=dijit.byId("ubigeo");var g=dijit.byId("nivel_modalidad");var i=dijit.byId("gestion");var a=dijit.byId("direccion_regional");var b=dijit.byId("ugel");var h=dijit.byId("codigo_ugel");depQueryTask=new esri.tasks.QueryTask("http://escale.minedu.gob.pe/medgis/rest/services/carto_base/lim_pol/MapServer/1");depQuery=new esri.tasks.Query();depQuery.where="1=1";depQuery.returnGeometry=false;depQuery.outFields=["IDDPTO","NOMBDEP"];depQueryTask.execute(depQuery,function(k){var l=[];var j=[];dojo.forEach(k.features,function(m){l.push({value:m.attributes.IDDPTO,label:m.attributes.NOMBDEP});j.push({value:m.attributes.IDDPTO,label:m.attributes.NOMBDEP})});c.addOption(l);a.addOption(j)});dojo.connect(c,"onChange",function(j){console.log("Departamento cambió.");console.log(j);if(j&&j!==""){console.log("Estoy ejecutando peticiones.");onDepartamentoChange(f,c,e,d,j)}else{e.removeOption(e.getOptions());e.addOption({label:":: Seleccione ::",value:""});e.setValue("");d.removeOption(d.getOptions());d.addOption({label:":: Seleccione ::",value:""});d.setValue("")}});dojo.connect(e,"onChange",function(j){console.log("Provincia cambió.");console.log(j);if(j&&j!==""){onProvinciaChange(f,c,e,d,j)}else{d.removeOption(d.getOptions());d.addOption({label:":: Seleccione ::",value:""});d.setValue("")}});dojo.connect(d,"onChange",function(j){console.log("Distrito cambió.");console.log(j);if(d.value!==""){distGeometryQueryTask=new esri.tasks.QueryTask("http://escale.minedu.gob.pe/medgis/rest/services/carto_base/lim_pol/MapServer/3");distGeometryQuery=new esri.tasks.Query();distGeometryQuery.where="IDDIST='"+j+"'";distGeometryQuery.returnGeometry=true;distGeometryQuery.outFields=[];distGeometryQueryTask.execute(distGeometryQuery,function(k){console.log(k);feature=k.features[0];centrarExtent(feature.geometry.getExtent())});f.set("value",d.value)}else{f.set("value",e.value)}});dojo.connect(a,"onChange",function(j){if(j&&j!==""){onDireccionRegionalChange(h,a,b,j)}else{b.removeOption(b.getOptions());b.addOption({label:":: Seleccione ::",value:""})}});dojo.connect(b,"onChange",function(j){if(b.value!==""){centrarExtent(b.getOptions(j).extent);h.set("value",b.value)}else{h.set("value",a.value)}});nivelOptions=[];nivelOptions.push({label:"Inicial",value:"A1|A2|A3"});nivelOptions.push({label:"Programa",value:"A5"});nivelOptions.push({label:"Primaria EBR",value:"B0"});nivelOptions.push({label:"Secundaria EBR",value:"F0"});nivelOptions.push({label:"Primaria EDA",value:"C0"});nivelOptions.push({label:"Secundaria EDA",value:"G0"});nivelOptions.push({label:"Básica alternativa",value:"D0"});nivelOptions.push({label:"Superior no universitaria",value:"K0|T0|M0"});nivelOptions.push({label:"Especial",value:"E0"});nivelOptions.push({label:"CETPRO",value:"L0"});g.addOption(nivelOptions);gestionOptions=[];gestionOptions.push({label:"Ministerio de Educación",value:"A1"});gestionOptions.push({label:"Otro sector público (FF.AA)",value:"A2"});gestionOptions.push({label:"Municipalidad",value:"A3"});gestionOptions.push({label:"Nacionales en convenio",value:"A4"});gestionOptions.push({label:"Cooperativo",value:"B1"});gestionOptions.push({label:"Comunidad o asociación religiosa",value:"B2"});gestionOptions.push({label:"Comunidad",value:"B3"});gestionOptions.push({label:"Particular",value:"B4"});gestionOptions.push({label:"Empresa",value:"B5"});gestionOptions.push({label:"Asociación civil / Institución benéfica",value:"B6"});i.addOption(gestionOptions);dojo.connect(dojo.query(".fm_find_trigger")[0],"onclick",function(){dijit.byId("tabs1").resize();dijit.byId("tabs2").resize()})}function centrarExtent(a){map.setExtent(a)}function onDepartamentoChange(a,d,e,c,b){depGeometryQueryTask=new esri.tasks.QueryTask("http://escale.minedu.gob.pe/medgis/rest/services/carto_base/lim_pol/MapServer/1");depGeometryQuery=new esri.tasks.Query();depGeometryQuery.where="IDDPTO='"+b+"'";depGeometryQuery.returnGeometry=true;depGeometryQuery.outFields=[];depGeometryQueryTask.execute(depGeometryQuery,function(f){feature=f.features[0];centrarExtent(feature.geometry.getExtent())});a.set("value",d.value);e.removeOption(e.getOptions());e.addOption({label:":: Seleccione ::",value:""});c.removeOption(c.getOptions());c.addOption({label:":: Seleccione ::",value:""});provQueryTask=new esri.tasks.QueryTask("http://escale.minedu.gob.pe/medgis/rest/services/carto_base/lim_pol/MapServer/2");provQuery=new esri.tasks.Query();provQuery.where="IDPROV LIKE '"+d.value+"%'";provQuery.returnGeometry=false;provQuery.outFields=["IDPROV","NOMBPROV"];provQueryTask.execute(provQuery,function(g){var f=[];dojo.forEach(g.features,function(h){f.push({value:h.attributes.IDPROV,label:h.attributes.NOMBPROV})});e.addOption(f)})}function onProvinciaChange(a,d,e,c,b){provGeometryQueryTask=new esri.tasks.QueryTask("http://escale.minedu.gob.pe/medgis/rest/services/carto_base/lim_pol/MapServer/2");provGeometryQuery=new esri.tasks.Query();provGeometryQuery.where="IDPROV='"+b+"'";provGeometryQuery.returnGeometry=true;provGeometryQuery.outFields=[];provGeometryQueryTask.execute(depGeometryQuery,function(f){feature=f.features[0];centrarExtent(feature.geometry.getExtent())});if(e.value!==""){a.set("value",e.value)}else{a.set("value",d.value)}c.removeOption(c.getOptions());c.addOption({label:":: Seleccione ::",value:""});distQueryTask=new esri.tasks.QueryTask("http://escale.minedu.gob.pe/medgis/rest/services/carto_base/lim_pol/MapServer/3");distQuery=new esri.tasks.Query();distQuery.where="IDPROV LIKE '"+e.value+"%'";distQuery.returnGeometry=false;distQuery.outFields=["IDDIST","NOMBDIST"];distQueryTask.execute(distQuery,function(f){var g=[];dojo.forEach(f.features,function(h){g.push({value:h.attributes.IDDIST,label:h.attributes.NOMBDIST})});c.addOption(g)})}function onDireccionRegionalChange(d,c,a,b){centrarExtent(c.getOptions(b).extent);d.set("value",c.value);a.removeOption(a.getOptions());a.addOption({label:":: Seleccione ::",value:""});ugelQueryTask=new esri.tasks.QueryTask("http://escale.minedu.gob.pe/medgis/rest/services/carto_base/ugel/MapServer/1");ugelQuery=new esri.tasks.Query();ugelQuery.where="CODUGEL LIKE '"+c.value+"%'";ugelQuery.returnGeometry=true;ugelQuery.outFields=["CODUGEL","UGEL"];ugelQueryTask.execute(ugelQuery,function(f){var e=[];dojo.forEach(f.features,function(g){e.push({value:g.attributes.CODUGEL,label:g.attributes.UGEL,extent:g.geometry.getExtent()})});a.addOption(e)})};